---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Environment Test - TypaVibe">
  <main>
    <div class="test-container">
      <h1>üîß Environment Variables Test</h1>
      
      <div class="test-section">
        <h2>Server-Side Environment Variables</h2>
        <div class="env-info">
          <p><strong>PUBLIC_SUPABASE_URL:</strong> {import.meta.env.PUBLIC_SUPABASE_URL ? '‚úÖ Present' : '‚ùå Missing'}</p>
          <p><strong>PUBLIC_SUPABASE_ANON_KEY:</strong> {import.meta.env.PUBLIC_SUPABASE_ANON_KEY ? '‚úÖ Present' : '‚ùå Missing'}</p>
        </div>
        
        {import.meta.env.PUBLIC_SUPABASE_URL && (
          <div class="env-details">
            <p><strong>URL:</strong> {import.meta.env.PUBLIC_SUPABASE_URL.substring(0, 30)}...</p>
            <p><strong>Key:</strong> {import.meta.env.PUBLIC_SUPABASE_ANON_KEY?.substring(0, 20)}...</p>
          </div>
        )}
      </div>
      
      <div class="test-section">
        <h2>Client-Side Environment Variables</h2>
        <div id="client-env">Loading...</div>
      </div>
      
      <div class="test-section">
        <h2>Netlify Environment Variables</h2>
        <div id="netlify-env">Loading...</div>
      </div>
    </div>
  </main>
</Layout>

<script>
  // Client-side environment check
  const clientEnv = {
    url: import.meta.env.PUBLIC_SUPABASE_URL,
    key: import.meta.env.PUBLIC_SUPABASE_ANON_KEY
  };
  
  document.getElementById('client-env').innerHTML = `
    <p><strong>PUBLIC_SUPABASE_URL:</strong> ${clientEnv.url ? '‚úÖ Present' : '‚ùå Missing'}</p>
    <p><strong>PUBLIC_SUPABASE_ANON_KEY:</strong> ${clientEnv.key ? '‚úÖ Present' : '‚ùå Missing'}</p>
    ${clientEnv.url ? `<p><strong>URL:</strong> ${clientEnv.url.substring(0, 30)}...</p>` : ''}
    ${clientEnv.key ? `<p><strong>Key:</strong> ${clientEnv.key.substring(0, 20)}...</p>` : ''}
  `;
  
  // Check for Netlify-specific environment variables
  const netlifyEnv = {
    siteUrl: import.meta.env.SITE_URL,
    context: import.meta.env.CONTEXT,
    deployUrl: import.meta.env.DEPLOY_URL
  };
  
  document.getElementById('netlify-env').innerHTML = `
    <p><strong>SITE_URL:</strong> ${netlifyEnv.siteUrl || 'Not set'}</p>
    <p><strong>CONTEXT:</strong> ${netlifyEnv.context || 'Not set'}</p>
    <p><strong>DEPLOY_URL:</strong> ${netlifyEnv.deployUrl || 'Not set'}</p>
  `;
</script>

<style>
  .test-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 24px;
  }
  
  .test-section {
    background: var(--color-background-secondary);
    border: 1.5px solid var(--color-border);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 24px;
  }
  
  .test-section h2 {
    margin-bottom: 16px;
    font-size: 1.1rem;
  }
  
  .env-info p {
    margin-bottom: 8px;
  }
  
  .env-details {
    margin-top: 16px;
    padding: 12px;
    background: #f3f4f6;
    border-radius: 6px;
    font-family: monospace;
    font-size: 12px;
  }
  
  .env-details p {
    margin: 4px 0;
  }
</style> 